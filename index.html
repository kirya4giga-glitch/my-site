<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Мой супер сайт</title>
    <script src="https://js-dos.com/v7/build/releases/latest/js-dos.js"></script>
    <style>
        :root {
            --bg-color: #0a0a0a;
            --main-color: #0F0;
            --box-bg: rgba(10, 25, 10, 0.6);
            --text-color: #0F0;
        }

        /* Темы */
        body.theme-tg {
            --bg-color: #17212b;
            --main-color: #5288c1;
            --box-bg: #242f3d;
            --text-color: #fff;
        }
        body.theme-light {
            --bg-color: #f0f2f5;
            --main-color: #0088cc;
            --box-bg: #ffffff;
            --text-color: #000;
        }

        body { 
            font-family: 'Consolas', monospace; text-align: center; padding: 20px; 
            background-color: var(--bg-color); color: var(--text-color); margin: 0; overflow-x: hidden;
            transition: 0.3s;
        }

        /* Настройки */
        .settings-btn {
            position: fixed; top: 15px; right: 15px; z-index: 100;
            cursor: pointer; background: var(--box-bg); padding: 8px; border-radius: 10px; border: 1px solid var(--main-color);
        }
        .settings-menu {
            display: none; position: fixed; top: 60px; right: 15px; z-index: 101;
            background: var(--box-bg); padding: 15px; border-radius: 10px; border: 1px solid var(--main-color);
            text-align: left; box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
        .settings-menu select { background: #000; color: #0F0; border: 1px solid #0F0; margin-bottom: 10px; width: 100%; }

        h1, h2 { color: var(--main-color); text-shadow: 0 0 5px var(--main-color); }
        .game-box {
            background: var(--box-bg); padding: 20px; border-radius: 15px; 
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.2); display: inline-block;
            margin-bottom: 30px; width: 95%; max-width: 450px;
            border: 1px solid var(--main-color); position: relative; z-index: 2;
        }
        .button-tea { 
            display: inline-block; padding: 12px 25px; background: rgba(0, 200, 0, 0.2); 
            color: var(--main-color); border: 1px solid var(--main-color); border-radius: 8px; 
            margin-bottom: 25px; cursor: pointer; font-weight: bold;
        }

        /* Чат */
        #cList {
            height: 250px; overflow-y: auto; background: rgba(0, 0, 0, 0.5); 
            padding: 10px; border-radius: 10px; display: flex; flex-direction: column; border: 1px solid var(--main-color);
        }
        .message {
            max-width: 85%; margin-bottom: 8px; padding: 8px 12px; border-radius: 12px; font-size: 14px;
            background: rgba(0, 255, 0, 0.1); border: 1px solid rgba(0,255,0,0.2); align-self: flex-start;
        }
        .del-btn { color: #ff4d4d; cursor: pointer; margin-left: 10px; }
        .chat-input-area { display: flex; gap: 5px; margin-top: 15px; }
        .chat-input-area input { flex: 1; padding: 10px; border: 1px solid var(--main-color); border-radius: 20px; background: #000; color: #0F0; }
        .send-btn { background: var(--main-color); color: #000; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; }

        /* Игры */
        canvas#snakeGame { background: #000; display: block; margin: 10px auto; width: 280px; height: 280px; border: 1px solid var(--main-color); }
        #doom-container { width: 100%; height: 300px; background: #000; border: 2px solid var(--main-color); margin-top: 10px; }
        #matrixCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-color: #000; }
    </style>
</head>
<body>

    <canvas id="matrixCanvas"></canvas>

    <div class="settings-btn" onclick="toggleSettings()">⚙️ <span id="set-txt">Настройки</span></div>
    <div class="settings-menu" id="sMenu">
        <label id="set-theme">Тема:</label>
        <select onchange="changeTheme(this.value)">
            <option value="hacker">Hacker (Green)</option>
            <option value="tg">Telegram (Blue)</option>
            <option value="light">Light (Day)</option>
        </select>
        <label id="set-lang">Язык:</label>
        <select onchange="changeLang(this.value)">
            <option value="ru">Русский</option>
            <option value="en">English</option>
            <option value="ua">Українська</option>
        </select>
    </div>
    
    <h1 id="h-title">Мой первый сайт</h1>
    <h2 id="h-subtitle">Делал сам честно!</h2>
    <div class="button-tea" id="btn-tea" onclick="alert('скинуть на чай будущему программисту:\n+79216274225 Сбербанк')">Нажми!</div>

    <div class="game-box">
        <h3 id="h-chat">чат (прототип номер 3)</h3>
        <div id="cList"></div>
        <div class="chat-input-area">
            <input type="text" id="nInp" placeholder="Имя">
            <input type="text" id="mInp" placeholder="Сообщение...">
            <button class="send-btn" onclick="addC()">></button>
        </div>
    </div>

    <div class="game-box">
        <h3 id="h-click">Кликер</h3>
        <div id="score" style="font-size: 30px;">0</div>
        <button class="button-tea" onclick="addScore()" id="btn-click">КЛИКНИ!</button>
    </div>

    <div class="game-box">
        <h3 id="h-snake">Змейка</h3>
        <canvas id="snakeGame" width="400" height="400"></canvas>
        <button class="button-tea" onclick="setD('up')">▲</button><br>
        <button class="button-tea" onclick="setD('left')">◀</button>
        <button class="button-tea" onclick="setD('down')">▼</button>
        <button class="button-tea" onclick="setD('right')">▶</button>
    </div>

    <div class="game-box">
        <h3>DOOM</h3>
        <div id="doom-container"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove, get, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyChSk0gETRBQ391e4BjPqFsKc_dzjBmT58",
            authDomain: "my-chat-52203.firebaseapp.com",
            databaseURL: "https://my-chat-52203-default-rtdb.firebaseio.com",
            projectId: "my-chat-52203",
            appId: "1:336944595953:web:24bfdf5041fc2040d17a50"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Регистрация и отправка
        window.addC = async function() {
            const n = document.getElementById('nInp').value.trim();
            const m = document.getElementById('mInp').value.trim();
            if(!n || !m) return;

            const uRef = ref(db, 'users/' + n);
            const snap = await get(uRef);

            if(snap.exists()){
                const p = prompt("Введите пароль для этого ника:");
                if(p !== snap.val().password) return alert("Неверно!");
            } else {
                const np = prompt("Придумайте пароль для защиты ника:");
                if(!np) return;
                await set(uRef, {password: np});
            }

            const now = new Date();
            push(ref(db, 'chat_messages'), { name: n, text: m, time: now.getHours() + ":" + (now.getMinutes()<10?'0':'') + now.getMinutes() });
            document.getElementById('mInp').value = "";
        };

        // Удаление (Пароль 8070)
        window.deleteMsg = (id) => {
            if(prompt("Пароль админа:") === "8070") remove(ref(db, 'chat_messages/' + id));
        };

        onValue(ref(db, 'chat_messages'), (s) => {
            const list = document.getElementById('cList');
            list.innerHTML = "";
            const data = s.val();
            for(let id in data) {
                list.innerHTML += `<div class="message"><b>${data[id].name}</b> <span class="del-btn" onclick="deleteMsg('${id}')">×</span><br>${data[id].text} <small style="display:block;text-align:right">${data[id].time}</small></div>`;
            }
            list.scrollTop = list.scrollHeight;
        });
    </script>

    <script>
        // Настройки
        function toggleSettings() { 
            const m = document.getElementById('sMenu');
            m.style.display = m.style.display === 'block' ? 'none' : 'block';
        }

        function changeTheme(v) {
            document.body.className = v === 'hacker' ? '' : 'theme-' + v;
            document.getElementById('matrixCanvas').style.display = (v === 'hacker') ? 'block' : 'none';
        }

        const langs = {
            ru: { title: "Мой первый сайт", subtitle: "Делал сам честно!", chat: "Чат", click: "Кликер", snake: "Змейка", settings: "Настройки" },
            en: { title: "My First Site", subtitle: "Made it myself!", chat: "Chat", click: "Clicker", snake: "Snake", settings: "Settings" },
            ua: { title: "Мій перший сайт", subtitle: "Робив сам чесно!", chat: "Чат", click: "Клікер", snake: "Змійка", settings: "Налаштування" }
        };

        function changeLang(l) {
            document.getElementById('h-title').innerText = langs[l].title;
            document.getElementById('h-subtitle').innerText = langs[l].subtitle;
            document.getElementById('h-chat').innerText = langs[l].chat;
            document.getElementById('h-click').innerText = langs[l].click;
            document.getElementById('h-snake').innerText = langs[l].snake;
            document.getElementById('set-txt').innerText = langs[l].settings;
        }

        // Кликер
        let count = 0;
        function addScore() { count++; document.getElementById('score').innerText = count; }

        // Змейка
        const sCanvas = document.getElementById("snakeGame");
        const sCtx = sCanvas.getContext("2d");
        let snake = [{x: 200, y: 200}], food = {x: 100, y: 100}, d = "";
        window.setD = (v) => d = v;
        function drawS() {
            sCtx.fillStyle = "#000"; sCtx.fillRect(0,0,400,400);
            sCtx.fillStyle = "red"; sCtx.fillRect(food.x, food.y, 20, 20);
            sCtx.fillStyle = "lime"; snake.forEach(s => sCtx.fillRect(s.x, s.y, 20, 20));
            let hX = snake[0].x, hY = snake[0].y;
            if(d=="up") hY-=20; if(d=="down") hY+=20; if(d=="left") hX-=20; if(d=="right") hX+=20;
            if(hX==food.x && hY==food.y) food = {x: Math.floor(Math.random()*19)*20, y: Math.floor(Math.random()*19)*20}; else if(d) snake.pop();
            if(d) {
                if(hX<0 || hX>=400 || hY<0 || hY>=400) { d=""; snake=[{x:200,y:200}]; }
                else snake.unshift({x:hX, y:hY});
            }
        }
        setInterval(drawS, 150);

        // Матрица
        const mCanvas = document.getElementById('matrixCanvas');
        const mCtx = mCanvas.getContext('2d');
        mCanvas.width = window.innerWidth; mCanvas.height = window.innerHeight;
        const drops = Array(Math.floor(mCanvas.width/16)).fill(1);
        function drawM() {
            mCtx.fillStyle = 'rgba(0, 0, 0, 0.05)'; mCtx.fillRect(0, 0, mCanvas.width, mCanvas.height);
            mCtx.fillStyle = '#0F0'; mCtx.font = '16px monospace';
            drops.forEach((y, i) => {
                mCtx.fillText('01', i * 16, y * 16);
                if (y * 16 > mCanvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            });
        }
        setInterval(drawM, 33);

        // DOOM
        Dos(document.getElementById("doom-container"), { style: "none" }).run("https://js-dos.com/v7/build/archive/doom.zip");
    </script>
</body>
</html>
