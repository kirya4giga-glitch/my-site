<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super App v5</title>
    <script src="https://js-dos.com/v7/build/releases/latest/js-dos.js"></script>
    <style>
        :root { --bg: #0a0a0a; --main: #0F0; --box: rgba(10, 25, 10, 0.7); --txt: #0F0; }
        body.theme-tg { --bg: #17212b; --main: #5288c1; --box: #242f3d; --txt: #fff; }
        body.theme-light { --bg: #f0f2f5; --main: #0088cc; --box: #ffffff; --txt: #000; }
        body.theme-retro { --bg: #1a1200; --main: #ffb000; --box: #2b1d00; --txt: #ffb000; }
        body.theme-cyber { --bg: #0d0015; --main: #ff00ff; --box: #1a0029; --txt: #00ffff; }

        body { font-family: 'Consolas', monospace; text-align: center; padding: 20px; background-color: var(--bg); color: var(--txt); margin: 0; transition: 0.3s; }
        .settings-btn { position: fixed; top: 15px; right: 15px; z-index: 100; cursor: pointer; background: var(--box); padding: 8px; border-radius: 10px; border: 1px solid var(--main); }
        .settings-menu { display: none; position: fixed; top: 60px; right: 15px; z-index: 101; background: var(--box); padding: 15px; border-radius: 10px; border: 1px solid var(--main); text-align: left; width: 220px; }
        
        .game-box { background: var(--box); padding: 20px; border-radius: 15px; box-shadow: 0 0 15px rgba(0,0,0,0.5); display: inline-block; margin-bottom: 30px; width: 95%; max-width: 450px; border: 1px solid var(--main); }
        .button-tea { display: inline-block; padding: 12px 25px; background: rgba(0,0,0,0.3); color: var(--main); border: 1px solid var(--main); border-radius: 8px; margin: 10px 0; cursor: pointer; font-weight: bold; }
        
        #cList { height: 300px; overflow-y: auto; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 10px; display: flex; flex-direction: column; border: 1px solid var(--main); margin-bottom: 10px; }
        .msg { margin-bottom: 10px; padding: 8px; border-radius: 8px; background: rgba(255,255,255,0.05); align-self: flex-start; text-align: left; width: 90%; position: relative; }
        .react-btn { background: none; border: 1px solid var(--main); color: var(--main); font-size: 10px; border-radius: 5px; cursor: pointer; margin-top: 5px; padding: 2px 5px; }
        
        .chat-area { display: flex; gap: 5px; }
        .chat-area input { flex: 1; padding: 12px; border: 1px solid var(--main); border-radius: 20px; background: #000; color: var(--main); outline: none; }
        
        canvas#snakeGame { background: #000; display: block; margin: 10px auto; width: 280px; height: 280px; border: 1px solid var(--main); }
        #doom-container { width: 100%; height: 300px; background: #000; border: 1px solid var(--main); }
        .doom-info { font-size: 11px; color: #ff4d4d; margin-top: 10px; line-height: 1.4; }
        
        #matrixCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.3; }
        input[readonly] { opacity: 0.6; cursor: not-allowed; }
    </style>
</head>
<body class="theme-hacker">
    <canvas id="matrixCanvas"></canvas>
    
    <div class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è <span id="set-txt">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span></div>
    <div class="settings-menu" id="sMenu">
        <label>–¢–µ–º–∞:</label>
        <select onchange="changeTheme(this.value)">
            <option value="hacker">Hacker</option>
            <option value="tg">Telegram</option>
            <option value="light">Light</option>
            <option value="retro">Retro Amber</option>
            <option value="cyber">Cyberpunk</option>
        </select>
        <hr>
        <button onclick="alert('–°–±–µ—Ä–±–∞–Ω–∫: +79216274225')">–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å</button>
    </div>

    <h1>Super App v5</h1>

    <div class="game-box">
        <h3>–ß–∞—Ç —Å —Ä–µ–∞–∫—Ü–∏—è–º–∏</h3>
        <div id="cList"></div>
        <div class="chat-area">
            <input type="text" id="nInp" placeholder="–ò–º—è" style="width:70px">
            <input type="text" id="mInp" placeholder="–¢–µ–∫—Å—Ç...">
            <button class="button-tea" style="margin:0; border-radius:50%" onclick="addC()">></button>
        </div>
    </div>

    <div class="game-box">
        <h3>–ö–ª–∏–∫–µ—Ä</h3>
        <div id="score" style="font-size:30px">0</div>
        <button class="button-tea" onclick="addScore()">–ö–õ–ò–ö–ù–ò!</button>
        <div id="leader-list" style="font-size:12px; text-align:left; border-top:1px solid var(--main); margin-top:10px"></div>
    </div>

    <div class="game-box">
        <h3>–ó–º–µ–π–∫–∞</h3>
        <div id="s-score">Score: 0</div>
        <canvas id="snakeGame" width="400" height="400"></canvas>
        <button class="button-tea" onclick="setD('up')">‚ñ≤</button><br>
        <button class="button-tea" onclick="setD('left')">‚óÄ</button>
        <button class="button-tea" onclick="setD('down')">‚ñº</button>
        <button class="button-tea" onclick="setD('right')">‚ñ∂</button>
    </div>

    <div class="game-box">
        <h3>DOOM 1993</h3>
        <div id="doom-container"></div>
        <div class="doom-info">
            üíª <b>–¢–û–õ–¨–ö–û –î–õ–Ø –ü–ö</b><br>
            –•–æ–¥–∏—Ç—å: —Å—Ç—Ä–µ–ª–∫–∏ | –û–≥–æ–Ω—å: Ctrl | –î–≤–µ—Ä—å: –ü—Ä–æ–±–µ–ª | –ë–µ–≥: Shift
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, set, get, update, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const conf = {
            apiKey: "AIzaSyChSk0gETRBQ391e4BjPqFsKc_dzjBmT58",
            databaseURL: "https://my-chat-52203-default-rtdb.firebaseio.com",
            projectId: "my-chat-52203"
        };
        const app = initializeApp(conf);
        const db = getDatabase(app);
        let pass = "";

        window.addC = async () => {
            const n = document.getElementById('nInp');
            const m = document.getElementById('mInp');
            if(!n.value || !m.value) return;

            if(!pass) {
                const s = await get(ref(db, 'users/'+n.value));
                if(s.exists()){
                    let p = prompt("–ü–∞—Ä–æ–ª—å:");
                    if(p !== s.val().password) return alert("–ù–µ–≤–µ—Ä–Ω–æ!");
                    pass = p;
                } else {
                    let p = prompt("–ü—Ä–∏–¥—É–º–∞–π –ø–∞—Ä–æ–ª—å:");
                    if(!p) return;
                    await set(ref(db, 'users/'+n.value), {password: p, score: 0});
                    pass = p;
                }
                n.readOnly = true;
            }
            push(ref(db, 'msgs'), {name: n.value, text: m.value, likes: 0});
            m.value = "";
        };

        window.addScore = () => {
            const n = document.getElementById('nInp').value;
            if(!pass) return alert("–í–æ–π–¥–∏—Ç–µ –≤ —á–∞—Ç!");
            const s = document.getElementById('score');
            let cur = parseInt(s.innerText) + 1;
            s.innerText = cur;
            if(cur === 100) alert("100 –∫–ª–∏–∫–æ–≤! –ò–¥–∏ —Ç—Ä–∞–≤—É –ø–æ—Ç—Ä–æ–≥–∞–π");
            update(ref(db, 'users/'+n), {score: cur});
        };

        window.doLike = (id, cur) => {
            update(ref(db, 'msgs/'+id), {likes: (cur || 0) + 1});
        };

        window.delMsg = (id) => {
            if(prompt("–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞:") === "8070") remove(ref(db, 'msgs/'+id));
        };

        onValue(ref(db, 'msgs'), (s) => {
            const l = document.getElementById('cList'); l.innerHTML = "";
            s.forEach(m => {
                const d = m.val();
                l.innerHTML += `<div class="msg">
                    <b>${d.name}</b> <span style="cursor:pointer;color:red" onclick="delMsg('${m.key}')">√ó</span><br>${d.text}<br>
                    <button class="react-btn" onclick="doLike('${m.key}', ${d.likes})">‚ù§Ô∏è ${d.likes || 0}</button>
                </div>`;
            });
            l.scrollTop = l.scrollHeight;
        });

        onValue(ref(db, 'users'), (s) => {
            const l = document.getElementById('leader-list'); l.innerHTML = "<b>–¢–û–ü:</b><br>";
            let users = [];
            s.forEach(u => users.push({n: u.key, s: u.val().score}));
            users.sort((a,b)=>b.s-a.s).slice(0,5).forEach(u => {
                l.innerHTML += `${u.n}: ${u.s} –∫–ª–∏–∫–æ–≤<br>`;
            });
        });
    </script>

    <script>
        function toggleSettings() { 
            const m = document.getElementById('sMenu'); 
            m.style.display = m.style.display === 'block' ? 'none' : 'block'; 
        }
        function changeTheme(v) { document.body.className = 'theme-' + v; }

        // –ó–º–µ–π–∫–∞
        let snake = [{x:200,y:200}], food = {x:100,y:100}, d = "", sScore = 0;
        const sCanvas = document.getElementById("snakeGame"); const sCtx = sCanvas.getContext("2d");
        window.setD = (v) => { if(v=='up'&&d!='down')d=v; if(v=='down'&&d!='up')d=v; if(v=='left'&&d!='right')d=v; if(v=='right'&&d!='left')d=v; };
        function drawS() {
            sCtx.fillStyle = "#000"; sCtx.fillRect(0,0,400,400);
            sCtx.fillStyle = "red"; sCtx.fillRect(food.x, food.y, 20, 20);
            snake.forEach((s, i) => { sCtx.fillStyle = i==0?"#ADFF2F":"#008000"; sCtx.fillRect(s.x, s.y, 20, 20); });
            let hX = snake[0].x, hY = snake[0].y;
            if(d=="up") hY-=20; if(d=="down") hY+=20; if(d=="left") hX-=20; if(d=="right") hX+=20;
            if(hX==food.x && hY==food.y) {
                sScore+=10; document.getElementById('s-score').innerText="Score: "+sScore;
                food = {x:Math.floor(Math.random()*19)*20, y:Math.floor(Math.random()*19)*20};
            } else if(d) snake.pop();
            if(d) {
                if(hX<0||hX>=400||hY<0||hY>=400||snake.some(s=>s.x==hX&&s.y==hY)) {
                    d=""; snake=[{x:200,y:200}]; sScore=0; document.getElementById('s-score').innerText="Score: 0";
                    alert("Game Over!");
                } else snake.unshift({x:hX, y:hY});
            }
        }
        setInterval(drawS, 120);

        // –ú–∞—Ç—Ä–∏—Ü–∞
        const mCanvas = document.getElementById('matrixCanvas'); const mCtx = mCanvas.getContext('2d');
        mCanvas.width = window.innerWidth; mCanvas.height = window.innerHeight;
        const drops = Array(Math.floor(mCanvas.width/16)).fill(1);
        function drawM() {
            mCtx.fillStyle = 'rgba(0,0,0,0.05)'; mCtx.fillRect(0,0,mCanvas.width,mCanvas.height);
            mCtx.fillStyle = '#0F0'; mCtx.font = '16px monospace';
            drops.forEach((y, i) => {
                mCtx.fillText(Math.random()>0.5?'0':'1', i*16, y*16);
                if(y*16>mCanvas.height && Math.random()>0.975) drops[i]=0;
                drops[i]++;
            });
        }
        setInterval(drawM, 33);

        // DOOM –ó–∞–ø—É—Å–∫
        try {
            Dos(document.getElementById("doom-container"), { 
                url: "https://js-dos.com/v7/build/archive/doom.zip",
                style: "none"
            });
        } catch(e) { console.log("DOOM error:", e); }
    </script>
</body>
</html>






