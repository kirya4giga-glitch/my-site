<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kiru OS v34.1 - GOD EDITION</title>
    <style>
        :root { 
            --bg: #000; --card-bg: rgba(28, 28, 30, 0.85); --txt: #fff; --main: #0A84FF; 
            --red: #FF453A; --green: #30D158; --gold: #FFD60A; --font: -apple-system, sans-serif;
            --shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        /* –¢–ï–ú–´ */
        body.t-light { --bg: #F2F2F7; --card-bg: rgba(255,255,255,0.8); --txt: #000; --main: #007AFF; --shadow: 0 10px 30px rgba(0,0,0,0.1); }
        body.t-hacker { --bg: #000; --card-bg: rgba(0, 20, 0, 0.9); --txt: #00FF41; --main: #008F11; }
        body.t-retro { --bg: #2b213a; --card-bg: rgba(255, 0, 128, 0.15); --txt: #ff0080; --main: #00e5ff; }
        body.t-snow { --bg: #e3f2fd; --card-bg: rgba(255,255,255,0.7); --txt: #01579b; --main: #0288d1; }
        body.t-cyber { --bg: #050510; --card-bg: rgba(20, 10, 40, 0.8); --txt: #00f3ff; --main: #bc13fe; --red: #ff003c; }

        body {
            background: var(--bg); color: var(--txt); font-family: var(--font);
            margin: 0; padding: 15px; overflow-x: hidden; transition: background 0.5s, color 0.5s;
            -webkit-user-select: none; user-select: none;
        }

        /* CANVAS BACK */
        #bg-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }

        /* UI ELEMENTS */
        .card {
            background: var(--card-bg); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-radius: 24px; padding: 20px; margin-bottom: 20px;
            box-shadow: var(--shadow); border: 1px solid rgba(128,128,128,0.1);
            animation: slideIn 0.4s ease-out;
        }

        .btn {
            background: var(--main); color: #fff; border: none; padding: 14px; 
            border-radius: 16px; font-weight: 600; font-size: 15px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; transition: 0.2s;
            width: 100%; margin-top: 5px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .btn:active { transform: scale(0.96); opacity: 0.8; }
        .btn-red { background: var(--red); }
        .btn-green { background: var(--green); }
        .btn-gold { background: var(--gold); color: #000; box-shadow: 0 0 15px rgba(255, 215, 0, 0.4); }

        input, select {
            width: 100%; padding: 12px; border-radius: 12px; border: 1px solid rgba(128,128,128,0.2);
            background: rgba(128,128,128,0.1); color: var(--txt); margin-bottom: 10px;
            font-size: 16px; outline: none; box-sizing: border-box;
        }

        /* HEADER */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .h-title { font-size: 24px; font-weight: 900; margin: 0; }
        .h-online { font-size: 11px; color: var(--green); font-weight: bold; }
        .icon-bar { display: flex; gap: 8px; }
        .icon-btn { width: 40px; height: 40px; padding: 0; font-size: 20px; margin: 0; }

        /* CLICKER AREA */
        #score-area { text-align: center; position: relative; }
        #balance { font-size: 56px; font-weight: 800; letter-spacing: -2px; line-height: 1; }
        .lvl-cont { background: rgba(128,128,128,0.2); height: 6px; border-radius: 3px; margin: 15px 0; overflow: hidden; }
        .lvl-fill { height: 100%; background: var(--main); width: 0%; transition: 0.3s; }
        .click-fx { position: absolute; font-weight: 900; font-size: 20px; pointer-events: none; animation: floatUp 0.8s forwards; color: var(--txt); }

        /* CHAT & LISTS */
        .scroll-list { height: 250px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; padding-bottom: 10px; }
        .msg { background: rgba(128,128,128,0.1); padding: 10px; border-radius: 14px; font-size: 13px; position: relative; }
        .msg b { cursor: pointer; opacity: 0.9; }
        .msg-time { font-size: 9px; opacity: 0.5; float: right; margin-top: 2px; }
        .del-btn { color: var(--red); font-weight: bold; cursor: pointer; margin-left: 10px; font-size: 16px; }

        .top-row { display: flex; justify-content: space-between; padding: 10px; background: rgba(128,128,128,0.05); border-radius: 12px; align-items: center; }
        .top-info { display: flex; flex-direction: column; gap: 2px; }
        .top-clicks { font-size: 10px; opacity: 0.6; font-weight: bold; color: var(--main); }

        /* MODALS */
        .modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 400px; max-height: 85vh; background: var(--card-bg); border-radius: 30px; z-index: 1000; padding: 25px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(40px); -webkit-backdrop-filter: blur(40px); box-shadow: 0 50px 100px rgba(0,0,0,0.8); }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 999; backdrop-filter: blur(4px); }
        .close-mod { position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; opacity: 0.6; }

        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-50px); } }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="t-dark">

    <canvas id="bg-canvas"></canvas>
    <div class="overlay" id="overlay"></div>

    <div class="header">
        <div>
            <h1 class="h-title">Kiru OS v34</h1>
            <div id="online-stat" class="h-online">‚óè Online: ...</div>
        </div>
        <div class="icon-bar">
            <button class="btn icon-btn btn-gold" onclick="openM('daily')">üéÅ</button>
            <button class="btn icon-btn" onclick="openM('clans')">üõ°Ô∏è</button>
            <button class="btn icon-btn" onclick="openM('shop')">üõí</button>
            <button class="btn icon-btn" onclick="openM('settings')">‚öôÔ∏è</button>
        </div>
    </div>

    <div class="card" id="score-area">
        <div id="lbl-bal" style="opacity:0.6; text-transform:uppercase; font-size:12px;">–ë–∞–ª–∞–Ω—Å</div>
        <div id="balance">0</div>
        
        <div style="display:flex; justify-content:space-between; font-size:12px; margin-top:10px; font-weight:bold;">
            <span id="lvl-txt">LVL 1</span>
            <span id="exp-txt">0 / 500</span>
        </div>
        <div class="lvl-cont"><div id="lvl-bar" class="lvl-fill"></div></div>

        <button class="btn" id="tap-btn" style="height:80px; font-size:24px; border-radius:24px;" onclick="tap(event)">TAP</button>
    </div>

    <div class="card">
        <h3 id="lbl-top">–¢–æ–ø –ò–≥—Ä–æ–∫–æ–≤</h3>
        <div id="top-list" class="scroll-list" style="height:180px;"></div>
    </div>

    <div class="card">
        <h3 id="lbl-games">–ú–∏–Ω–∏-–∏–≥—Ä—ã</h3>
        <div style="display:flex; gap:10px;">
            <button class="btn" onclick="findGame('ttt')">–ö—Ä–µ—Å—Ç–∏–∫–∏</button>
            <button class="btn" onclick="findGame('chess')">–®–∞—Ö–º–∞—Ç—ã</button>
        </div>
    </div>

    <div class="card">
        <h3 id="lbl-chat">–ß–∞—Ç</h3>
        <div id="chat-list" class="scroll-list"></div>
        <div style="display:flex; gap:8px;">
            <input type="text" id="msg-in" style="margin:0;" placeholder="...">
            <button class="btn" style="width:60px; margin:0;" onclick="sendMsg()">‚û§</button>
        </div>
    </div>

    <div id="shop" class="modal"><span class="close-mod" onclick="closeM()">√ó</span><h2 id="lbl-shop">–ú–∞–≥–∞–∑–∏–Ω</h2><div class="top-row"><span>ü§ñ AutoClick (+1/s)</span><button class="btn" style="width:auto" onclick="buy('auto', 5000)">5k</button></div><div class="top-row"><span>‚ö° Multiplier (+2)</span><button class="btn" style="width:auto" onclick="buy('mult', 10000)">10k</button></div><div class="top-row"><span>üëë Prefix [VIP]</span><button class="btn" style="width:auto" onclick="buy('pref', 50000, 'VIP')">50k</button></div><div class="top-row"><span>üé® Nick Color</span><button class="btn" style="width:auto" onclick="buy('col', 25000, 'rainbow')">25k</button></div><hr style="opacity:0.2"><h3>Rebirth</h3><button class="btn btn-red" onclick="doRebirth()">–°–¥–µ–ª–∞—Ç—å Rebirth (–ù—É–∂–Ω–æ 1M)</button></div>
    <div id="clans" class="modal"><span class="close-mod" onclick="closeM()">√ó</span><h2 id="lbl-clan">–ö–ª–∞–Ω—ã</h2><div id="clan-create-ui"><input id="clan-name-in" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞"><button class="btn" onclick="createClan()">–°–æ–∑–¥–∞—Ç—å (100k)</button></div><div id="clan-my-ui" style="display:none;"><h3 id="my-clan-name"></h3><p id="my-clan-stats"></p><div id="clan-mems"></div><button class="btn btn-red" onclick="leaveClan()">–ü–æ–∫–∏–Ω—É—Ç—å / –£–¥–∞–ª–∏—Ç—å</button></div><h4>–°–ø–∏—Å–æ–∫ –∫–ª–∞–Ω–æ–≤:</h4><div id="clan-list" class="scroll-list"></div></div>
    <div id="settings" class="modal"><span class="close-mod" onclick="closeM()">√ó</span><h2 id="lbl-set">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2><label>Language:</label><select id="lang-sel" onchange="changeLang(this.value)"><option value="rus">–†—É—Å—Å–∫–∏–π</option><option value="eng">English</option><option value="ukr">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option></select><label>Theme:</label><select onchange="setTheme(this.value)"><option value="dark">Dark iOS</option><option value="light">Light iOS</option><option value="hacker">Hacker</option><option value="snow">Snow</option><option value="retro">Retro</option><option value="cyber">Cyberpunk</option></select><button class="btn btn-gold" onclick="openM('support')">‚òï –ü–æ–¥–¥–µ—Ä–∂–∫–∞</button><button class="btn btn-green" onclick="openM('credits')">üåü –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏</button><button class="btn btn-red" onclick="resetUpgrades()">‚ö† –°–±—Ä–æ—Å —É–ª—É—á—à–µ–Ω–∏–π</button><button class="btn btn-red" onclick="logout()">–í—ã–π—Ç–∏</button></div>
    <div id="support" class="modal"><span class="close-mod" onclick="closeM()">√ó</span><h3>–ù–∞ —á–∞–π ‚òï</h3><h2 style="color:var(--main);">+79216274225</h2></div>
    <div id="credits" class="modal"><span class="close-mod" onclick="closeM()">√ó</span><h3>–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏</h3><ul style="list-style:none; padding:0;"><li>üëë –í–∞–¥–µ–∫</li><li>üòé –°–∞—à–∞</li><li>üêπ –ê–Ω–∞—Å—Ç–∞—Å–∏—è –ó–µ–º–ª–µ—Ä–æ–π–∫–∞</li><li>üëæ –¢–µ–ø–µ</li><li>üî• –ê–Ω–¥—Ä–µ–πüòé</li><li id="musya-egg" style="color:var(--red); font-weight:bold; cursor:pointer">‚ù§Ô∏è –ú—É—Å—è</li></ul></div>
    <div id="daily" class="modal" style="text-align:center;"><span class="close-mod" onclick="closeM()">√ó</span><h2>–ù–∞–≥—Ä–∞–¥–∞</h2><div id="daily-status">...</div><button class="btn btn-gold" id="daily-btn" onclick="claimDaily()">–ó–∞–±—Ä–∞—Ç—å 10,000</button></div>
    <div id="game-win" class="modal" style="text-align:center;"><h3 id="g-title">Game</h3><div id="g-status">–û–∂–∏–¥–∞–Ω–∏–µ...</div><div id="g-board" style="margin:20px auto;"></div><button class="btn btn-red" onclick="quitGame()">–í—ã–π—Ç–∏</button></div>
    <div id="profile" class="modal"><span class="close-mod" onclick="closeM()">√ó</span><h2 id="p-name"></h2><div id="p-stats"></div><hr><div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"><button class="btn" onclick="sendMoneyUi()">üí∏ Send $</button><button class="btn btn-red" onclick="adminAct('mute')">Mute</button><button class="btn btn-red" onclick="adminAct('unmute')">Unmute</button><button class="btn btn-red" onclick="adminAct('reset')">Wipe $</button></div></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, get, update, push, onValue, remove, serverTimestamp, onDisconnect } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const db = getDatabase(initializeApp({ apiKey: "AIzaSyChSk0gETRBQ391e4BjPqFsKc_dzjBmT58", databaseURL: "https://my-chat-52203-default-rtdb.firebaseio.com", projectId: "my-chat-52203" }));

        let user = JSON.parse(localStorage.getItem('kiru_god_v34'));
        let loopId = null, canvasId = null, curGameId = null;

        const txt = {
            rus: { bal:"–ë–∞–ª–∞–Ω—Å", top:"–¢–æ–ø –ò–≥—Ä–æ–∫–æ–≤", chat:"–ß–∞—Ç", games:"–ú–∏–Ω–∏-–∏–≥—Ä—ã", shop:"–ú–∞–≥–∞–∑–∏–Ω", set:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏", clan:"–ö–ª–∞–Ω—ã" },
            eng: { bal:"Balance", top:"Leaderboard", chat:"Chat", games:"Mini-Games", shop:"Shop", set:"Settings", clan:"Clans" },
            ukr: { bal:"–ë–∞–ª–∞–Ω—Å", top:"–¢–æ–ø –ì—Ä–∞–≤—Ü—ñ–≤", chat:"–ß–∞—Ç", games:"–ú—ñ–Ω—ñ-—ñ–≥—Ä–∏", shop:"–ú–∞–≥–∞–∑–∏–Ω", set:"–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è", clan:"–ö–ª–∞–Ω–∏" }
        };

        async function init() {
            if(!user) {
                let n = prompt("–ù–∏–∫:"); let p = prompt("–ü–∞—Ä–æ–ª—å:");
                if(!n || !p) return location.reload();
                const snap = await get(ref(db, 'users/'+n));
                if(snap.exists()) {
                    if(snap.val().pass !== p) { alert("Wrong Pass!"); return location.reload(); }
                    user = {name:n, ...snap.val()};
                } else {
                    user = {name:n, pass:p, score:0, clicks:0, lvl:1, exp:0, mult:1, auto:0, wins:0, clan:'', musya:false, reb:0};
                    await set(ref(db, 'users/'+n), user);
                }
                saveUser();
            }
            onValue(ref(db, 'users/'+user.name), s => { if(s.exists()) { user = {name:user.name, ...s.val()}; updateUI(); } });
            const conRef = ref(db, 'status/'+user.name); set(conRef, true); onDisconnect(conRef).remove();
            onValue(ref(db, 'status'), s => document.getElementById('online-stat').innerText = `‚óè Online: ${s.size||0}`);
            loadChat(); loadTop(); loadClans();
            loopId = setInterval(() => { if(user.auto > 0) addScore(user.auto, false); checkDaily(); }, 1000);
            changeLang('rus'); setTheme('dark');
        }

        function addScore(amt, isClick) {
            let nx = (user.exp||0) + (isClick?1:0);
            let nl = user.lvl || 1;
            if(nx >= nl*500) { nx=0; nl++; }
            update(ref(db, 'users/'+user.name), {
                score: (user.score||0) + Math.floor(amt),
                clicks: (user.clicks||0) + (isClick?1:0),
                exp: nx, lvl: nl
            });
        }

        window.tap = (e) => {
            let pwr = (user.mult||1) * (user.reb ? user.reb*2 : 1);
            addScore(pwr, true);
            let el = document.createElement('div'); el.className = 'click-fx'; el.innerText = '+' + pwr;
            el.style.left = e.clientX + 'px'; el.style.top = e.clientY + 'px';
            document.body.appendChild(el); setTimeout(() => el.remove(), 700);
        };

        // –¢–ê–ë–õ–ò–¶–ê –õ–ò–î–ï–†–û–í –° –ö–õ–ò–ö–ê–ú–ò –ò –£–î–ê–õ–ï–ù–ò–ï–ú
        function loadTop() {
            onValue(ref(db, 'users'), s => {
                let list = document.getElementById('top-list'); list.innerHTML='';
                let arr = [];
                s.forEach(x => arr.push({n:x.key, ...x.val()}));
                arr.sort((a,b) => b.score - a.score).slice(0,10).forEach((u,i) => {
                    list.innerHTML += `
                        <div class="top-row">
                            <div class="top-info">
                                <span>#${i+1} ${u.n} [${u.lvl||1}]</span>
                                <span class="top-clicks">–ö–õ–ò–ö–ò: ${u.clicks || 0}</span>
                            </div>
                            <div style="display:flex; align-items:center; gap:10px;">
                                <b>${Math.floor(u.score).toLocaleString()}</b>
                                <span class="del-btn" onclick="removePlayer('${u.n}')">√ó</span>
                            </div>
                        </div>`;
                });
            });
        }

        window.removePlayer = async (targetName) => {
            let pass = prompt(`–í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω-–ø–∞—Ä–æ–ª—å –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è ${targetName}:`);
            if(pass === "8070") {
                if(confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –£–î–ê–õ–ò–¢–¨ –∏–≥—Ä–æ–∫–∞ ${targetName} –Ω–∞–≤—Å–µ–≥–¥–∞?`)) {
                    await remove(ref(db, 'users/' + targetName));
                    alert("–ò–≥—Ä–æ–∫ —É–¥–∞–ª–µ–Ω!");
                }
            } else {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
            }
        };

        window.sendMsg = async () => {
            let t = document.getElementById('msg-in').value;
            if(!t.trim()) return;
            if((user.muteUntil||0) > Date.now()) return alert("Muted!");
            await push(ref(db, 'msgs'), {n:user.name, t:t, tm:serverTimestamp(), pref:user.pref||'', col:user.col||''});
            document.getElementById('msg-in').value = '';
        };

        function loadChat() {
            onValue(ref(db, 'msgs'), s => {
                let div = document.getElementById('chat-list'); div.innerHTML = '';
                s.forEach(ss => {
                    let m = ss.val();
                    div.innerHTML += `<div class="msg"><span style="color:${m.col||'var(--main)'}">[${m.pref||'USER'}]</span> <b onclick="showProf('${m.n}')">${m.n}</b>: ${m.t} <span class="del-btn" onclick="delMsg('${ss.key}')">√ó</span></div>`;
                });
                div.scrollTop = div.scrollHeight;
            });
        }

        // –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (–°–æ–∫—Ä–∞—â–µ–Ω–Ω–æ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏, –æ–Ω–∏ —Ç–µ –∂–µ)
        window.delMsg = (k) => { if(prompt("Admin:") === "8070") remove(ref(db, 'msgs/'+k)); };
        function updateUI() {
            document.getElementById('balance').innerText = Math.floor(user.score).toLocaleString();
            document.getElementById('lvl-txt').innerText = "LVL " + (user.lvl||1);
            let max = (user.lvl||1)*500;
            document.getElementById('lvl-bar').style.width = ((user.exp||0)/max*100) + "%";
            saveUser();
        }
        window.saveUser = () => localStorage.setItem('kiru_god_v34', JSON.stringify(user));
        window.openM = (id) => { document.getElementById(id).style.display='block'; document.getElementById('overlay').style.display='block'; };
        window.closeM = () => { document.querySelectorAll('.modal').forEach(x=>x.style.display='none'); document.getElementById('overlay').style.display='none'; };
        window.changeLang = (l) => {
            let t = txt[l]; document.getElementById('lbl-bal').innerText = t.bal; document.getElementById('lbl-top').innerText = t.top;
            document.getElementById('lbl-chat').innerText = t.chat; document.getElementById('lbl-games').innerText = t.games;
            document.getElementById('lbl-shop').innerText = t.shop; document.getElementById('lbl-set').innerText = t.set;
            document.getElementById('lbl-clan').innerText = t.clan;
        };
        window.setTheme = (t) => {
            document.body.className = 't-'+t;
            if(canvasId) clearInterval(canvasId);
            let c = document.getElementById('bg-canvas'); c.width = window.innerWidth; c.height = window.innerHeight;
            let ctx = c.getContext('2d');
            if(t==='hacker') {
                let d = Array(Math.floor(c.width/20)).fill(1);
                canvasId = setInterval(()=> { ctx.fillStyle="rgba(0,0,0,0.1)"; ctx.fillRect(0,0,c.width,c.height); ctx.fillStyle="#0F0"; d.forEach((y,i)=>{ctx.fillText(String.fromCharCode(0x30A0+Math.random()*96),i*20,y*20); if(y*20>c.height&&Math.random()>0.9)d[i]=0; d[i]++;});}, 50);
            }
        };

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>

























