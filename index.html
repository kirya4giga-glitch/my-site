<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Мой первый сайт</title>
    <style>
        body { font-family: -apple-system, sans-serif; text-align: center; padding: 20px; background-color: #f0f0f0; margin: 0; }
        .game-box {
            background: white; padding: 15px; border-radius: 15px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: inline-block;
            margin-bottom: 20px; width: 95%; max-width: 400px;
        }
        .button-tea { 
            display: inline-block; padding: 10px 20px; background: #fff; 
            border: 1px solid #ccc; border-radius: 8px; margin-bottom: 20px; cursor: pointer; font-weight: bold;
        }

        /* ЧАТ */
        #cList {
            height: 300px; overflow-y: auto; background: #e5ddd5; 
            padding: 10px; border-radius: 10px; display: flex; flex-direction: column; border: 1px solid #ddd;
        }
        .message {
            max-width: 85%; margin-bottom: 8px; padding: 8px 12px;
            border-radius: 12px; font-size: 14px; text-align: left; box-shadow: 0 1px 1px rgba(0,0,0,0.1);
            background: white; align-self: flex-start;
        }
        .msg-name { font-weight: bold; font-size: 11px; color: #3390ec; display: flex; justify-content: space-between; }
        .msg-time { font-size: 9px; color: #999; margin-top: 4px; text-align: right; display: block; }
        .del-btn { color: #ff4d4d; cursor: pointer; font-weight: normal; margin-left: 10px; }

        .chat-input-area { display: flex; gap: 5px; margin-top: 10px; }
        .chat-input-area input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 20px; outline: none; }
        .send-btn { background: #3390ec; color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; }

        /* КЛИКЕР */
        #score { font-size: 40px; font-weight: bold; color: #2ecc71; margin: 5px 0; }
        .click-btn { padding: 15px; background: lime; border: 2px solid #333; border-radius: 12px; font-weight: bold; width: 100%; cursor: pointer; }
        .reset-link { color: red; text-decoration: underline; cursor: pointer; font-size: 12px; display: block; margin-top: 10px; }

        /* ЗМЕЙКА */
        canvas { background: #000; display: block; margin: 10px auto; width: 280px; height: 280px; border-radius: 5px; }
        .snake-ctrl { display: grid; grid-template-columns: repeat(3, 55px); gap: 8px; justify-content: center; }
        .s-btn { width: 55px; height: 55px; background: #fff; border: 1px solid #ccc; border-radius: 10px; font-size: 18px; }
    </style>
</head>
<body>

    <h1>Мой сайт</h1>
    <h2>Делал сам честно!</h2>
    <div class="button-tea" onclick="alert('скинуть на чай будущему программисту: +79216274225 сбербанк')">Нажми! </div>

    <div class="game-box">
        <h3>чат (прототип номер 3)</h3>
        <div id="cList"></div>
        <div class="chat-input-area">
            <input type="text" id="nInp" placeholder="Имя" style="width: 70px;">
            <input type="text" id="mInp" placeholder="Сообщение...">
            <button class="send-btn" onclick="addC()">></button>
        </div>
    </div>

    <div class="game-box">
        <h3>Кликер</h3>
        <div id="score">0</div>
        <button class="click-btn" onclick="addScore()">КЛИКНИ!</button>
        <span class="reset-link" onclick="resetScore()">обнулить счет</span>
    </div>

    <div class="game-box">
        <h3>Змейка</h3>
        <canvas id="snakeGame" width="400" height="400"></canvas>
        <div class="snake-ctrl">
            <div></div><button class="s-btn" onclick="setD('up')">▲</button><div></div>
            <button class="s-btn" onclick="setD('left')">◀</button>
            <button class="s-btn" onclick="setD('down')">▼</button>
            <button class="s-btn" onclick="setD('right')">▶</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyChSk0gETRBQ391e4BjPqFsKc_dzjBmT58",
            authDomain: "my-chat-52203.firebaseapp.com",
            databaseURL: "https://my-chat-52203-default-rtdb.firebaseio.com",
            projectId: "my-chat-52203",
            appId: "1:336944595953:web:24bfdf5041fc2040d17a50"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const messagesRef = ref(db, 'chat_messages');

        window.addC = function() {
            const n = document.getElementById('nInp').value;
            const m = document.getElementById('mInp').value;
            if(n && m) {
                const now = new Date();
                const time = now.getHours() + ":" + (now.getMinutes()<10?'0':'') + now.getMinutes();
                push(messagesRef, { name: n, text: m, time: time });
                document.getElementById('mInp').value = "";
            }
        };

        window.deleteMsg = function(id) {
            const password = prompt("Пароль админа:");
            if (password === "8070") { // <--- ЗАМЕНИ 1234 НА СВОЙ ПАРОЛЬ
                remove(ref(db, 'chat_messages/' + id));
            } else {
                alert("Неверно!");
            }
        };

        onValue(messagesRef, (snapshot) => {
            const data = snapshot.val();
            const list = document.getElementById('cList');
            list.innerHTML = "";
            for (let id in data) {
                const msg = data[id];
                list.innerHTML += `
                    <div class="message">
                        <span class="msg-name">${msg.name} <span class="del-btn" onclick="deleteMsg('${id}')">×</span></span>
                        ${msg.text}
                        <span class="msg-time">${msg.time}</span>
                    </div>`;
            }
            list.scrollTop = list.scrollHeight;
        });
    </script>

    <script>
        let count = parseInt(localStorage.getItem('myScore')) || 0;
        document.getElementById('score').innerText = count;
        function addScore() {
            count++;
            document.getElementById('score').innerText = count;
            localStorage.setItem('myScore', count);
            if(count === 100) alert("100 кликов! Иди потрогай траву)");
        }
        function resetScore() {
            if(confirm("точно обнулить?")) { count=0; document.getElementById('score').innerText=0; localStorage.removeItem('myScore'); }
        }

        const canvas = document.getElementById("snakeGame");
        const ctx = canvas.getContext("2d");
        const box = 20;
        let snake = [{x: 10 * box, y: 10 * box}];
        let food = { x: Math.floor(Math.random()*19+1)*box, y: Math.floor(Math.random()*19+1)*box };
        let d = "";
        window.setD = (newD) => {
            if(newD=="left" && d!="right") d="left";
            if(newD=="up" && d!="down") d="up";
            if(newD=="right" && d!="left") d="right";
            if(newD=="down" && d!="up") d="down";
        };
        function draw() {
            ctx.fillStyle = "black"; ctx.fillRect(0,0,400,400);
            ctx.fillStyle = "red"; ctx.fillRect(food.x, food.y, box, box);
            for(let i=0; i<snake.length; i++) { ctx.fillStyle = (i==0) ? "lime" : "green"; ctx.fillRect(snake[i].x, snake[i].y, box, box); }
            let sX = snake[0].x; let sY = snake[0].y;
            if(d=="left") sX-=box; if(d=="up") sY-=box; if(d=="right") sX+=box; if(d=="down") sY+=box;
            if(sX==food.x && sY==food.y) { food = { x: Math.floor(Math.random()*19+1)*box, y: Math.floor(Math.random()*19+1)*box }; } else if(d!="") { snake.pop(); }
            if(d!="") {
                let head = {x:sX, y:sY};
                if(sX<0 || sX>=400 || sY<0 || sY>=400 || snake.some(s => s.x==head.x && s.y==head.y)) { d=""; snake=[{x: 10*box, y: 10*box}]; alert("Game Over!"); } else { snake.unshift(head); }
            }
        }
        setInterval(draw, 150);
    </script>
</body>
</html>


