<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kiru OS v31.0 - TITAN EDITION</title>
    <style>
        :root { 
            --bg: #000; --main: #0A84FF; --txt: #fff; 
            --glass: rgba(255, 255, 255, 0.08); 
            --card: rgba(28, 28, 30, 0.8);
            --red: #FF453A; --green: #32D74B; --orange: #FF9F0A; --purple: #BF5AF2;
            --gold: #FFD700;
        }
        body.theme-hacker { --bg: #000; --main: #32D74B; --txt: #32D74B; --glass: rgba(0,255,0,0.05); }
        body.theme-ios-light { --bg: #F2F2F7; --main: #007AFF; --txt: #000; --glass: rgba(255, 255, 255, 0.7); --card: rgba(255,255,255,0.9); }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            background: var(--bg); color: var(--txt); margin: 0; padding: 15px; 
            overflow-x: hidden; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* –ê–ù–ò–ú–ê–¶–ò–ò */
        @keyframes pop { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        @keyframes float-up { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 100% { transform: translate(1px, -1px) rotate(0deg); } }
        @keyframes gold-glow { 0% { box-shadow: 0 0 5px var(--gold); } 50% { box-shadow: 0 0 20px var(--gold); } 100% { box-shadow: 0 0 5px var(--gold); } }

        .ios-card { 
            background: var(--glass); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px);
            padding: 20px; border-radius: 24px; border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); animation: pop 0.5s ease;
        }

        .btn { 
            padding: 12px 16px; background: var(--main); color: #fff; border: none; 
            border-radius: 14px; cursor: pointer; font-weight: 600; font-size: 15px;
            transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center;
        }
        .btn:active { transform: scale(0.92); }
        .btn-red { background: var(--red); }
        .btn-orange { background: var(--orange); }
        .btn-gold { background: var(--gold); color: #000; animation: gold-glow 2s infinite; }

        /* –ò–ì–†–û–í–´–ï –≠–õ–ï–ú–ï–ù–¢–´ */
        #cList { height: 300px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; scroll-behavior: smooth; }
        .msg { background: rgba(255,255,255,0.06); padding: 12px; border-radius: 18px; font-size: 14px; border-left: 4px solid var(--main); position: relative; }
        .msg-system { border-left-color: var(--gold); background: rgba(255,215,0,0.1); font-weight: bold; }
        .msg-time { font-size: 9px; opacity: 0.4; float: right; }
        
        .status-dot { width: 8px; height: 8px; background: var(--green); border-radius: 50%; display: inline-block; margin-right: 5px; }
        
        .top-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: rgba(255,255,255,0.04); border-radius: 16px; margin-bottom: 5px; }
        .my-rank { border: 1.5px solid var(--main); background: rgba(10,132,255,0.15); }

        /* –ö–õ–ò–ö-–≠–§–§–ï–ö–¢ */
        .click-particle { position: absolute; color: var(--gold); font-weight: 900; pointer-events: none; animation: float-up 0.8s forwards; z-index: 10000; }

        /* –ì–û–†–Ø–ß–ö–ê */
        #fever-bar { display: none; background: linear-gradient(90deg, var(--red), var(--orange)); padding: 5px; text-align: center; border-radius: 10px; font-weight: 900; color: white; margin-bottom: 10px; animation: shake 0.5s infinite; }

        input { background: rgba(255,255,255,0.08); border: none; padding: 14px; border-radius: 14px; color: #fff; width: 100%; box-sizing: border-box; }
        
        .modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--card); backdrop-filter: blur(50px); border-radius: 32px; width: 90%; max-width: 400px; z-index: 9999; padding: 25px; border: 1px solid rgba(255,255,255,0.15); max-height: 80vh; overflow-y: auto; }
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 9998; }
        
        .badge { font-size: 10px; padding: 2px 6px; border-radius: 5px; margin-right: 5px; text-transform: uppercase; font-weight: bold; }
        
        /* –°–ï–¢–ö–ê –ì–†–ò–î */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    </style>
</head>
<body class="theme-ios-dark">

    <div id="fever-bar">üî• –ì–û–†–Ø–ß–ö–ê X3 –ö–õ–ò–ö –ê–ö–¢–ò–í–ù–ê! üî•</div>
    <div class="overlay" id="overlay"></div>

    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
        <div>
            <h1 style="margin:0; font-size: 26px; font-weight: 900;">Kiru OS <span style="color:var(--main)">v31.0</span></h1>
            <div id="online-info" style="font-size: 11px; color: var(--green); font-weight: bold;">‚óè –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
        </div>
        <div style="display:flex; gap:8px;">
            <button class="btn" onclick="openMod('clanWin')">üõ°Ô∏è</button>
            <button class="btn btn-gold" onclick="openMod('dailyWin')">üéÅ</button>
            <button class="btn" onclick="openMod('shopWin')">üõí</button>
            <button class="btn" onclick="openMod('sMenu')">‚öôÔ∏è</button>
        </div>
    </div>

    <div class="ios-card" style="text-align:center; position: relative;" id="tap-area">
        <div id="jackpot-info" style="font-size: 12px; color: var(--gold); margin-bottom: 10px;">–î–∂–µ–∫–ø–æ—Ç: 0 üí∞</div>
        <div style="opacity: 0.6; font-size: 14px;">–í–∞—à –∫–∞–ø–∏—Ç–∞–ª</div>
        <div id="score" style="font-size: 60px; font-weight: 950; letter-spacing: -3px; margin: 5px 0;">0</div>
        <div id="rebirth-level" style="color: var(--purple); font-weight: bold; margin-bottom: 10px;">–ü—Ä–µ—Å—Ç–∏–∂: 0</div>
        
        <button class="btn" id="mainTapBtn" onclick="doClick(event)" style="width:100%; padding:25px; font-size:22px; border-radius:24px; box-shadow: 0 10px 30px rgba(10,132,255,0.4);">–¢–ê–ü–ê–¢–¨</button>
        
        <div class="top-list" id="topContent" style="margin-top:20px;"></div>
    </div>

    <div class="ios-card">
        <div style="display:flex; justify-content:space-between;">
            <h3 style="margin:0;">iChat Global</h3>
            <span id="typing-notify" style="font-size: 10px; opacity: 0.5;"></span>
        </div>
        <div id="cList"></div>
        <div style="display:flex; gap:8px;">
            <input type="text" id="mInp" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç...">
            <button class="btn" onclick="sendMsg()" style="width:60px;">‚Üí</button>
        </div>
    </div>

    <div id="shopWin" class="modal">
        <h2>–ú–∞–≥–∞–∑–∏–Ω –ë—É—Å—Ç–æ–≤</h2>
        <div class="grid-2" id="shopItems">
            <div class="top-item" style="flex-direction:column;">ü§ñ –ê–≤—Ç–æ +1<button class="btn" onclick="buy('auto', 5000, 1)">5k</button></div>
            <div class="top-item" style="flex-direction:column;">üè≠ –ó–∞–≤–æ–¥ +50<button class="btn" onclick="buy('auto', 100000, 50)">100k</button></div>
            <div class="top-item" style="flex-direction:column;">üöÄ –¢—É—Ä–±–æ +10<button class="btn" onclick="buy('multi', 50000, 10)">50k</button></div>
            <div class="top-item" style="flex-direction:column;">üåà –¶–≤–µ—Ç –Ω–∏–∫–∞<button class="btn" onclick="buy('color', 25000, 'rainbow')">25k</button></div>
            <div class="top-item" style="flex-direction:column;">üèÜ [TITAN]<button class="btn" onclick="buy('prefix', 1000000, 'TITAN')">1M</button></div>
        </div>
        <hr>
        <button class="btn btn-purple" style="width:100%" onclick="doRebirth()">–°–¥–µ–ª–∞—Ç—å –ü–†–ï–°–¢–ò–ñ (–ù—É–∂–Ω–æ 10–ú)</button>
        <button class="btn" onclick="closeMod('shopWin')" style="width:100%; margin-top:10px;">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <div id="dailyWin" class="modal">
        <h2>–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞</h2>
        <div id="daily-status" style="text-align:center; padding: 20px 0;"></div>
        <button class="btn btn-gold" id="claimDailyBtn" onclick="claimDaily()" style="width:100%;">–ó–∞–±—Ä–∞—Ç—å 5000 üí∞</button>
        <button class="btn" onclick="closeMod('dailyWin')" style="width:100%; margin-top:10px;">–ù–∞–∑–∞–¥</button>
    </div>

    <div id="clanWin" class="modal">
        <h2>–ö–ª–∞–Ω—ã</h2>
        <div id="clan-info">
            <input type="text" id="clanNameInp" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∞–Ω–∞">
            <button class="btn" onclick="createClan()" style="width:100%; margin-top:5px;">–°–æ–∑–¥–∞—Ç—å –∫–ª–∞–Ω (100–∫)</button>
        </div>
        <div id="clanList" style="margin-top:15px;"></div>
        <button class="btn" onclick="closeMod('clanWin')" style="width:100%; margin-top:10px;">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <div id="sMenu" class="modal">
        <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ TITAN</h3>
        <button class="btn btn-orange" onclick="openMod('thanksWin')" style="width:100%;">üåü –ê–≤—Ç–æ—Ä—ã –∏ –ú—É—Å—è</button>
        <button class="btn btn-red" onclick="resetItems()" style="width:100%; margin-top:10px;">–°–±—Ä–æ—Å —É–ª—É—á—à–µ–Ω–∏–π</button>
        <button class="btn btn-red" onclick="logout()" style="width:100%; margin-top:10px;">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</button>
        <button class="btn" onclick="closeMod('sMenu')" style="width:100%; margin-top:10px;">X</button>
    </div>

    <div id="thanksWin" class="modal">
        <h3>–õ–µ–≥–µ–Ω–¥—ã</h3>
        <ul style="list-style:none; padding:0; line-height:2;">
            <li>–í–∞–¥–µ–∫ (Founder)</li>
            <li id="musyaEaster" style="cursor:pointer; font-weight:900; color:var(--red);">–ú—É—Å—è ‚ù§Ô∏è</li>
            <li>–ê–Ω–∞—Å—Ç–∞—Å–∏—è –ó–µ–º–ª–µ—Ä–æ–π–∫–∞</li>
            <li>–°–∞—à–∞</li>
            <li>–ê–Ω–¥—Ä–µ–πüòé</li>
            <li>–¢–µ–ø–µ</li>
            <li>Gemini AI</li>
        </ul>
        <button class="btn" onclick="closeMod('thanksWin')" style="width:100%;">–ù–∞–∑–∞–¥</button>
    </div>

    <div id="pCard" class="modal">
        <h2 id="pc-name">User</h2>
        <div id="pc-stats" style="margin-bottom:15px;"></div>
        <div class="grid-2">
            <button class="btn" onclick="sendMoney()">üí∏ –î–æ–Ω–∞—Ç</button>
            <button class="btn btn-orange" onclick="adminMute()">Mute</button>
            <button class="btn btn-orange" onclick="adminUnmute()">Unmute</button>
            <button class="btn btn-red" onclick="adminResetMoney()">–û–±–Ω—É–ª–∏—Ç—å</button>
        </div>
        <button class="btn" onclick="closeMod('pCard')" style="width:100%; margin-top:10px;">X</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, get, update, push, onValue, remove, serverTimestamp, onDisconnect } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const conf = { apiKey: "AIzaSyChSk0gETRBQ391e4BjPqFsKc_dzjBmT58", databaseURL: "https://my-chat-52203-default-rtdb.firebaseio.com", projectId: "my-chat-52203" };
        const db = getDatabase(initializeApp(conf));

        let user = JSON.parse(localStorage.getItem('k_user_v31'));
        let mClicks = 0;
        let isFever = false;
        let viewUser = "";

        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        async function init() {
            if(!user) {
                let n = prompt("–ù–∏–∫:"); let p = prompt("–ü–∞—Ä–æ–ª—å:");
                if(!n || !p) return;
                const s = await get(ref(db, 'users/'+n));
                if(s.exists()){ 
                    if(s.val().password !== p) return location.reload(); 
                    user={name:n, ...s.val()}; 
                } else { 
                    user={name:n, password:p, score:0, mult:1, autoclicker:0, rebirth:0, prefix:'', lastDaily:0}; 
                    await set(ref(db, 'users/'+n), user); 
                }
                localStorage.setItem('k_user_v31', JSON.stringify(user));
            }

            // –°—Ç–∞—Ç—É—Å –æ–Ω–ª–∞–π–Ω
            const statusRef = ref(db, 'status/' + user.name);
            set(statusRef, true);
            onDisconnect(statusRef).remove();

            // –°–ª—É—à–∞—Ç–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–∞
            onValue(ref(db, 'users/'+user.name), s => {
                if(s.exists()){
                    user = {name:user.name, ...s.val()};
                    document.getElementById('score').innerText = Math.floor(user.score).toLocaleString();
                    document.getElementById('rebirth-level').innerText = "–ü—Ä–µ—Å—Ç–∏–∂: " + (user.rebirth || 0);
                }
            });

            // –°–ª—É—à–∞—Ç–µ–ª—å –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π (–ì–æ—Ä—è—á–∫–∞, –î–∂–µ–∫–ø–æ—Ç)
            onValue(ref(db, 'global'), s => {
                const data = s.val() || {};
                isFever = data.fever || false;
                document.getElementById('fever-bar').style.display = isFever ? 'block' : 'none';
                document.getElementById('jackpot-info').innerText = `–î–∂–µ–∫–ø–æ—Ç: ${(data.jackpot || 0).toLocaleString()} üí∞`;
            });

            loadChat(); loadTop(); loadClans(); checkOnlineCount();
            
            // –ó–∞—Ü–∏–∫–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
            setInterval(autoClick, 1000);
            setInterval(onlineBonus, 60000); // –†–∞–∑ –≤ –º–∏–Ω—É—Ç—É –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–æ–Ω—É—Å
        }

        // –¢–ê–ü –ò –≠–§–§–ï–ö–¢–´
        window.doClick = (e) => {
            let power = (user.mult || 1) * (user.rebirth > 0 ? user.rebirth * 2 : 1);
            if(isFever) power *= 3;
            
            update(ref(db, 'users/'+user.name), {score: Number(user.score) + power});
            
            // –ß–∞—Å—Ç–∏—Ü–∞ –∫–ª–∏–∫–∞
            const p = document.createElement('div');
            p.className = 'click-particle';
            p.innerText = `+${power}`;
            p.style.left = e.pageX + 'px';
            p.style.top = e.pageY + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);
        };

        function autoClick() {
            if(user.autoclicker > 0) {
                update(ref(db, 'users/'+user.name), {score: Number(user.score) + user.autoclicker});
            }
        }

        // –†–ï–ë–Å–†–¢
        window.doRebirth = async () => {
            if(user.score < 10000000) return alert("–ù—É–∂–Ω–æ 10,000,000 –∫–æ–∏–Ω–æ–≤!");
            if(confirm("–°–±—Ä–æ—Å–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏ —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–¥–∏ –≤–µ—á–Ω–æ–≥–æ x2 –º–Ω–æ–∂–∏—Ç–µ–ª—è?")){
                await update(ref(db, 'users/'+user.name), {
                    score: 0, mult: 1, autoclicker: 0, 
                    rebirth: (user.rebirth || 0) + 1,
                    prefix: 'PRESTIGE'
                });
                systemMsg(`üëë –ò–≥—Ä–æ–∫ ${user.name} —Å–æ–≤–µ—Ä—à–∏–ª –ü–†–ï–°–¢–ò–ñ! –£—Ä–æ–≤–µ–Ω—å: ${user.rebirth + 1}`);
            }
        };

        // –ï–ñ–ï–î–ù–ï–í–ö–ê
        window.claimDaily = async () => {
            const now = Date.now();
            if(now - (user.lastDaily || 0) < 86400000) return alert("–ü—Ä–∏—Ö–æ–¥–∏ –∑–∞–≤—Ç—Ä–∞!");
            await update(ref(db, 'users/'+user.name), {score: Number(user.score) + 5000, lastDaily: now});
            alert("–ó–∞–±—Ä–∞–ª 5,000 üí∞!");
        };

        // –ß–ê–¢
        window.sendMsg = async () => {
            const i = document.getElementById('mInp');
            if(!i.value.trim()) return;
            const s = await get(ref(db, 'users/'+user.name));
            if(s.val().muteUntil > Date.now()) return alert("–í—ã –∑–∞–º—É—á–µ–Ω—ã!");
            
            await push(ref(db, 'msgs'), {
                n: user.name, t: i.value, time: serverTimestamp(),
                pref: s.val().prefix, col: s.val().color
            });
            
            // –®–∞–Ω—Å –Ω–∞ –¥–∂–µ–∫–ø–æ—Ç –ø—Ä–∏ —Å–æ–æ–±—â–µ–Ω–∏–∏ (0.5%)
            if(Math.random() < 0.005) winJackpot();
            i.value = "";
        };

        function loadChat() {
            onValue(ref(db, 'msgs'), s => {
                const l = document.getElementById('cList'); l.innerHTML = "";
                s.forEach(d => {
                    const m = d.val();
                    const isSys = m.n === 'SYSTEM';
                    l.innerHTML += `
                        <div class="msg ${isSys?'msg-system':''}">
                            ${!isSys?'<span class="msg-del" onclick="adminDelMsg(\''+d.key+'\')">√ó</span>':''}
                            <span class="prefix" style="background:${m.col==='rainbow'?'linear-gradient(to right, red, orange, yellow, green, blue, indigo, violet)':(m.col||'#fff')}">${m.pref||'USER'}</span>
                            <b onclick="showP('${m.n}')" style="color:${m.col==='rainbow'?'#BF5AF2':(m.col||'inherit')}">${m.n}</b>: ${m.t}
                        </div>
                    `;
                });
                l.scrollTop = l.scrollHeight;
            });
        }

        // –ö–õ–ê–ù–´
        window.createClan = async () => {
            const name = document.getElementById('clanNameInp').value;
            if(!name || user.score < 100000) return alert("–ù—É–∂–Ω–æ 100–∫ –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ");
            await set(ref(db, 'clans/'+name), { owner: user.name, bank: 0 });
            await update(ref(db, 'users/'+user.name), { score: user.score - 100000, clan: name });
            systemMsg(`üõ°Ô∏è –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –∫–ª–∞–Ω: [${name}]`);
        };

        function loadClans() {
            onValue(ref(db, 'clans'), s => {
                const l = document.getElementById('clanList'); l.innerHTML = "<h4>–¢–æ–ø –ö–ª–∞–Ω–æ–≤:</h4>";
                s.forEach(d => {
                    l.innerHTML += `<div class="top-item"><span>${d.key}</span><b>${d.val().bank} üí∞</b></div>`;
                });
            });
        }

        // –°–ò–°–¢–ï–ú–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function winJackpot() {
            get(ref(db, 'global/jackpot')).then(s => {
                const win = s.val() || 50000;
                update(ref(db, 'users/'+user.name), {score: Number(user.score) + win});
                set(ref(db, 'global/jackpot'), 1000);
                systemMsg(`üé∞ –î–ñ–ï–ö–ü–û–¢! ${user.name} –≤—ã–∏–≥—Ä–∞–ª ${win.toLocaleString()} üí∞ –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —á–∞—Ç–µ!`);
            });
        }

        async function systemMsg(txt) {
            await push(ref(db, 'msgs'), { n: 'SYSTEM', t: txt, time: serverTimestamp(), col: '#FFD700', pref: 'üì¢' });
        }

        window.buy = async (t, p, v) => {
            if(user.score < p) return alert("–ú–∞–ª–æ –¥–µ–Ω–µ–≥!");
            let up = {score: Number(user.score) - p};
            if(t==='auto') up.autoclicker = (user.autoclicker||0)+v;
            if(t==='multi') up.mult = (user.mult||1)+v;
            if(t==='prefix') up.prefix = v;
            if(t==='color') up.color = v;
            await update(ref(db, 'users/'+user.name), up);
            systemMsg(`üõí ${user.name} –ø—Ä–∏–æ–±—Ä—ë–ª –∞–ø–≥—Ä–µ–π–¥: ${v}`);
        };

        function loadTop() {
            onValue(ref(db, 'users'), s => {
                const c = document.getElementById('topContent'); c.innerHTML = "";
                let a = []; s.forEach(u => { a.push({n: u.key, s: Number(u.val().score) || 0, r: u.val().rebirth||0}); });
                a.sort((x,y) => y.s - x.s).slice(0,5).forEach((u,i) => {
                    c.innerHTML += `<div class="top-item ${u.n===user.name?'my-rank':''}"><span>#${i+1} ${u.n} ${u.r>0?'‚≠ê'+u.r:''}</span><b>${Math.floor(u.s).toLocaleString()}</b></div>`;
                });
            });
        }

        // –ê–î–ú–ò–ù–ö–ê
        window.adminResetMoney = () => { if(prompt("Pass:")==="8070") update(ref(db, 'users/'+viewUser), {score: 0}); };
        window.adminMute = () => { if(prompt("Pass:")==="8070") update(ref(db, 'users/'+viewUser), {muteUntil: Date.now()+3600000}); };
        window.adminUnmute = () => { if(prompt("Pass:")==="8070") update(ref(db, 'users/'+viewUser), {muteUntil: 0}); };
        window.adminDelMsg = (id) => { if(prompt("Pass:")==="8070") remove(ref(db, 'msgs/'+id)); };

        // –ú–£–°–Ø ‚ù§Ô∏è
        document.getElementById('musyaEaster').onclick = () => {
            mClicks++;
            if(mClicks === 5) {
                update(ref(db, 'users/'+user.name), {score: Number(user.score) + 50000});
                alert("üíñ –ú–£–°–Ø –õ–Æ–ë–ò–¢ –¢–ï–ë–Ø! +50,000 üí∞");
                mClicks = 0;
            }
        };

        window.showP = async n => { if(n==='SYSTEM')return; viewUser=n; const s=await get(ref(db, 'users/'+n)); const d=s.val(); document.getElementById('pc-name').innerText=n; document.getElementById('pc-stats').innerText=`–ë–∞–ª–ª—ã: ${d.score} | –†–µ–±—ë—Ä—Ç—ã: ${d.rebirth||0}`; openMod('pCard'); };
        window.openMod = id => { document.getElementById(id).style.display='block'; document.getElementById('overlay').style.display='block'; };
        window.closeMod = id => { document.getElementById(id).style.display='none'; document.getElementById('overlay').style.display='none'; };
        window.logout = () => { localStorage.clear(); location.reload(); };
        function checkOnlineCount() { onValue(ref(db, 'status'), s => { document.getElementById('online-info').innerText = `‚óè –í –°–ï–¢–ò: ${s.size || 0}`; }); }

        init();
    </script>
</body>
</html>








































